/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * cadastro_bairro.java
 *
 * Created on 19/03/2010, 15:13:57
 */

package Cadastro;

import javax.swing.*;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableModel;
import auxiliar.conexao;
import auxiliar.validaLogin;

/**
 *
 * @author ayrton monier
 */
public class cadastro_bairro extends javax.swing.JDialog {

    private conexao con_bairros;
    private String direcao;
    private String ordenacao = "cod_bairro";
    private int navega;
    private boolean grava;
    public String dataFormatadataJTable;
    
    
    /** Creates new form cadastro_bairro */
    public cadastro_bairro(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
       
        con_bairros = new conexao();
        con_bairros.conecta();

        atualizaResultset();
        preencherJtable();
        
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        jSeparator1 = new javax.swing.JSeparator();
        cb_listaBairros = new javax.swing.JComboBox();
        btNovo = new javax.swing.JButton();
        jLabel6 = new javax.swing.JLabel();
        btExcluir = new javax.swing.JButton();
        btSair = new javax.swing.JButton();
        jLabel7 = new javax.swing.JLabel();
        btGrava = new javax.swing.JButton();
        tf_consulta = new javax.swing.JTextField();
        tf_cod = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        rb_codigo = new javax.swing.JRadioButton();
        rb_nome = new javax.swing.JRadioButton();
        tf_nome = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tCidades = new javax.swing.JTable();
        tf_qtdBairros = new javax.swing.JTextField();
        btAnterior = new javax.swing.JButton();
        btUltimo = new javax.swing.JButton();
        btPrimeiro = new javax.swing.JButton();
        btProximo = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
        setTitle("Matenção do registro de bairros - Sistemas Serquip - 1.0");
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowClosing(java.awt.event.WindowEvent evt) {
                formWindowClosing(evt);
            }
        });

        cb_listaBairros.setToolTipText("Pressione [ENTER] para mostrar nos campos");
        cb_listaBairros.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cb_listaBairrosActionPerformed(evt);
            }
        });
        cb_listaBairros.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                cb_listaBairrosKeyTyped(evt);
            }
        });

        btNovo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/adicionar.png"))); // NOI18N
        btNovo.setMnemonic('a');
        btNovo.setToolTipText("Novo registro");
        btNovo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btNovoActionPerformed(evt);
            }
        });

        jLabel6.setText("Consultar:");

        btExcluir.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/excluir.png"))); // NOI18N
        btExcluir.setMnemonic('b');
        btExcluir.setToolTipText("Excluir registro");
        btExcluir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btExcluirActionPerformed(evt);
            }
        });

        btSair.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/sair.png"))); // NOI18N
        btSair.setMnemonic('e');
        btSair.setToolTipText("Sair");
        btSair.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btSairActionPerformed(evt);
            }
        });

        jLabel7.setText("Bairros:");

        btGrava.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/gravar.png"))); // NOI18N
        btGrava.setMnemonic('s');
        btGrava.setToolTipText("Salvar ou atualizar registro");
        btGrava.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btGravaActionPerformed(evt);
            }
        });

        tf_consulta.setToolTipText("Digite parte do nome e pressione [ENTER]");
        tf_consulta.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tf_consultaActionPerformed(evt);
            }
        });
        tf_consulta.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                tf_consultaFocusLost(evt);
            }
        });

        tf_cod.setEditable(false);

        jLabel1.setText("Cód.:");

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder("Ordenação"));

        buttonGroup1.add(rb_codigo);
        rb_codigo.setSelected(true);
        rb_codigo.setText("Código");
        rb_codigo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rb_codigoActionPerformed(evt);
            }
        });

        buttonGroup1.add(rb_nome);
        rb_nome.setText("Nome");
        rb_nome.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rb_nomeActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(rb_codigo)
                    .addComponent(rb_nome))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addComponent(rb_codigo)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(rb_nome))
        );

        jLabel2.setText("Nome:");

        tCidades.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Código", "Nome do bairro", "Data cadastro"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tCidades.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tCidadesMouseClicked(evt);
            }
        });
        tCidades.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                tCidadesKeyReleased(evt);
            }
        });
        jScrollPane1.setViewportView(tCidades);

        tf_qtdBairros.setEditable(false);
        tf_qtdBairros.setFont(new java.awt.Font("Tahoma", 1, 12));
        tf_qtdBairros.setForeground(new java.awt.Color(255, 51, 0));
        tf_qtdBairros.setBorder(javax.swing.BorderFactory.createTitledBorder("Qtd. de bairros"));

        btAnterior.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/anterior.png"))); // NOI18N
        btAnterior.setToolTipText("Registro anterior");
        btAnterior.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btAnteriorActionPerformed(evt);
            }
        });

        btUltimo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/ultimo.png"))); // NOI18N
        btUltimo.setToolTipText("Último registro");
        btUltimo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btUltimoActionPerformed(evt);
            }
        });

        btPrimeiro.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/primeiro.png"))); // NOI18N
        btPrimeiro.setToolTipText("Primeiro registro");
        btPrimeiro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btPrimeiroActionPerformed(evt);
            }
        });

        btProximo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/proximo.png"))); // NOI18N
        btProximo.setToolTipText("Próximo registro");
        btProximo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btProximoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                                .addComponent(jLabel6)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(tf_consulta, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel7)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(cb_listaBairros, 0, 185, Short.MAX_VALUE))
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel2)
                                    .addComponent(jLabel1))
                                .addGap(20, 20, 20)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(tf_cod, javax.swing.GroupLayout.PREFERRED_SIZE, 128, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(tf_nome, javax.swing.GroupLayout.DEFAULT_SIZE, 251, Short.MAX_VALUE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(btPrimeiro, javax.swing.GroupLayout.PREFERRED_SIZE, 45, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btAnterior, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btProximo, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btUltimo, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btGrava, javax.swing.GroupLayout.PREFERRED_SIZE, 47, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btNovo, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btExcluir, javax.swing.GroupLayout.PREFERRED_SIZE, 47, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btSair, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(tf_qtdBairros, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 123, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 405, Short.MAX_VALUE))
                .addContainerGap())
            .addComponent(jSeparator1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 425, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                        .addComponent(jLabel7)
                        .addComponent(jLabel6)
                        .addComponent(tf_consulta))
                    .addComponent(cb_listaBairros, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel1, javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(tf_cod, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel2)
                            .addComponent(tf_nome, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(11, 11, 11)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btSair, javax.swing.GroupLayout.DEFAULT_SIZE, 41, Short.MAX_VALUE)
                    .addComponent(btExcluir, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btNovo, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btGrava, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btUltimo, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btProximo, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btAnterior, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btPrimeiro, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(tf_qtdBairros, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 132, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        pack();
        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        java.awt.Dimension dialogSize = getSize();
        setLocation((screenSize.width-dialogSize.width)/2,(screenSize.height-dialogSize.height)/2);
    }// </editor-fold>//GEN-END:initComponents

    private void cb_listaBairrosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cb_listaBairrosActionPerformed
        // TODO add your handling code here:
}//GEN-LAST:event_cb_listaBairrosActionPerformed

    private void cb_listaBairrosKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cb_listaBairrosKeyTyped
        informaBairro();
}//GEN-LAST:event_cb_listaBairrosKeyTyped

    private void btNovoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btNovoActionPerformed
        limpaCampos();
        tf_nome.setEditable(true);
        tf_nome.requestFocus();
        habilitaBotoes(false);
    }//GEN-LAST:event_btNovoActionPerformed

    private void btExcluirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btExcluirActionPerformed
        if(tf_cod.getText().isEmpty())
            JOptionPane.showMessageDialog(null, "Selecione um registro através dos botoes de navegação", "Aviso", JOptionPane.WARNING_MESSAGE);
        else
            excluirRegistro();
}//GEN-LAST:event_btExcluirActionPerformed

    private void btSairActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btSairActionPerformed
        int opcao_escolhida = JOptionPane.showConfirmDialog(null, "Deseja realmente sair?", "Sair", JOptionPane.YES_NO_OPTION);

        if(opcao_escolhida == JOptionPane.YES_OPTION){

            //apos fechar nao atualiza dados da tela de cadstro de clientes
            auxiliar.validaCadCli.atualizaDadosManutencao = false;
            con_bairros.desconecta();
            dispose();
        } else
            return;
}//GEN-LAST:event_btSairActionPerformed

    private void btGravaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btGravaActionPerformed

        validaCampos();

        //se grava for verdadeiro(gravou no bd);
        if(grava == true){

            //sem caixa de texto onde tem o cod do cliente estiver vazia grava os dados
            if(tf_cod.getText().isEmpty())
                gravaDados();

            else{

                int opcao = JOptionPane.showConfirmDialog(null, "Deseja atualizar o cadastro?", "Confirmação", JOptionPane.YES_NO_OPTION);

                if(opcao == JOptionPane.YES_OPTION)
                    atualizaDados();
                else
                    return;
            }
        }//fim 1° if
}//GEN-LAST:event_btGravaActionPerformed

    private void tf_consultaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tf_consultaActionPerformed
        pesquisarBairroPorNome();
}//GEN-LAST:event_tf_consultaActionPerformed

    private void tf_consultaFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_tf_consultaFocusLost
        tf_consulta.setText("");
}//GEN-LAST:event_tf_consultaFocusLost

    private void rb_codigoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rb_codigoActionPerformed
        ordenacao = "cod_bairro";
        atualizaResultset();
        preencherJtable();
    }//GEN-LAST:event_rb_codigoActionPerformed

    private void rb_nomeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rb_nomeActionPerformed
        ordenacao = "nome_bairro";
        atualizaResultset();
        preencherJtable();
    }//GEN-LAST:event_rb_nomeActionPerformed

    private void tCidadesMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tCidadesMouseClicked
        cliqueGrid();
}//GEN-LAST:event_tCidadesMouseClicked

    private void tCidadesKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tCidadesKeyReleased
        cliqueGrid();
}//GEN-LAST:event_tCidadesKeyReleased

    private void btAnteriorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btAnteriorActionPerformed
        navega = 1;
        if(tf_cod.getText().isEmpty() && (tf_nome.getText().length()>0)){
            int opc = JOptionPane.showConfirmDialog(null, "O registro atual será apagado. Deseja continuar?", "Aviso", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);

            if(opc == JOptionPane.YES_OPTION){
                //posição do registro
                direcao = "primeiro";
                //chama o metodo que resolve a navegação dos botoes
                btNavega();

            } else{
                return;
            }
        } else{
            //posição do registro
            direcao = "anterior";
            //chama o metodo que resolve a navegação dos botoes
            btNavega();

        }
}//GEN-LAST:event_btAnteriorActionPerformed

    private void btUltimoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btUltimoActionPerformed
        if(tf_cod.getText().isEmpty() && (tf_nome.getText().length()>0)){
            int opc = JOptionPane.showConfirmDialog(null, "O registro atual será apagado. Deseja continuar?", "Aviso", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);

            if(opc == JOptionPane.YES_OPTION){
                //posição do registro
                direcao = "ultimo";
                //chama o metodo que resolve a navegação dos botoes
                btNavega();

            } else{
                return;
            }
        } else{
            //posição do registro
            direcao = "ultimo";
            //chama o metodo que resolve a navegação dos botoes
            btNavega();

        }
}//GEN-LAST:event_btUltimoActionPerformed

    private void btPrimeiroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btPrimeiroActionPerformed

        if(tf_cod.getText().isEmpty() && (tf_nome.getText().length()>0)){
            int opc = JOptionPane.showConfirmDialog(null, "O registro atual será apagado. Deseja continuar?", "Aviso", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);

            if(opc == JOptionPane.YES_OPTION){
                //posição do registro
                direcao = "primeiro";
                //chama o metodo que resolve a navegação dos botoes
                btNavega();

            } else{
                return;
            }
        } else{
            //posição do registro
            direcao = "primeiro";
            //chama o metodo que resolve a navegação dos botoes
            btNavega();

        }
}//GEN-LAST:event_btPrimeiroActionPerformed

    private void btProximoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btProximoActionPerformed
        navega = 2;
        if(tf_cod.getText().isEmpty() && (tf_nome.getText().length()>0)){
            int opc = JOptionPane.showConfirmDialog(null, "O registro atual será apagado. Deseja continuar?", "Aviso", JOptionPane.YES_NO_OPTION, JOptionPane.WARNING_MESSAGE);

            if(opc == JOptionPane.YES_OPTION){//se apertar em sim
                //posição do registro
                direcao = "proximo";
                //chama o metodo que resolve a navegação dos botoes
                btNavega();

            } else{//se apertar em não
                return;
            }
        } else{
            //posição do registro
            direcao = "proximo";
            //chama o metodo que resolve a navegação dos botoes
            btNavega();

        }
}//GEN-LAST:event_btProximoActionPerformed

    private void formWindowClosing(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowClosing
        int opcao_escolhida = JOptionPane.showConfirmDialog(null, "Deseja realmente sair?", "Sair", JOptionPane.YES_NO_OPTION);

        if(opcao_escolhida == JOptionPane.YES_OPTION){

            //apos fechar nao atualiza dados da tela de cadstro de clientes
            auxiliar.validaCadCli.atualizaDadosManutencao = false;
            con_bairros.desconecta();
            dispose();
        } else
            return;
    }//GEN-LAST:event_formWindowClosing

    /**
    * @param args the command line arguments
    */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                cadastro_bairro dialog = new cadastro_bairro(new javax.swing.JFrame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btAnterior;
    public javax.swing.JButton btExcluir;
    private javax.swing.JButton btGrava;
    private javax.swing.JButton btNovo;
    private javax.swing.JButton btPrimeiro;
    private javax.swing.JButton btProximo;
    private javax.swing.JButton btSair;
    private javax.swing.JButton btUltimo;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JComboBox cb_listaBairros;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JRadioButton rb_codigo;
    private javax.swing.JRadioButton rb_nome;
    private javax.swing.JTable tCidades;
    public static javax.swing.JTextField tf_cod;
    private javax.swing.JTextField tf_consulta;
    public javax.swing.JTextField tf_nome;
    private javax.swing.JTextField tf_qtdBairros;
    // End of variables declaration//GEN-END:variables


public void limpaCampos(){


         tf_cod.setText("");
         tf_nome.setText("");

}

//GRAVA OS DADOS DE PESO BOMBONA
public void gravaDados(){

auxiliar.Data.le_data();
try{

String sqlInsert = "insert into cad_bairro (nome_bairro" +
            ", data_cadastro)" +
            //valores dos campos
            " values ('"+tf_nome.getText().toUpperCase()+"'"+   //nome bairro
            ", '"+auxiliar.Data.dataAtualBD+"')";               //data


    int gravado = con_bairros.statement.executeUpdate(sqlInsert);

    //se conseguiu gravar, retorna 1 e entra no if
    if(gravado == 1){
    JOptionPane.showMessageDialog(null, "GRAVAÇÃO EFETUADA COM SUCESSO.");

        limpaCampos();
        atualizaResultset();
        preencherListaBairros();// na minha tela
        preencherJtable();//atualiza tabela

        //se o registro for feito da da tela de clientes
        if(auxiliar.validaCadCli.atualizaDadosManutencao == true){
            
            auxiliar.validaCadCli.preencherListaDeBairros();// na tela de clientes

            if(CadastroCliente.codigoCli.getText().isEmpty())
                return;
            else
                auxiliar.validaCadCli.mostraDadosCadCli();
        }


    }
}//fim try

catch(Exception e){
    JOptionPane.showMessageDialog(null, "ERRO AO TENTAR GRAVAR O REGISTRO. Erro:"+e, "erro", JOptionPane.ERROR_MESSAGE);
}


}//fim grava dados

public void preencherJtable(){


tCidades.getColumnModel().getColumn(0).setPreferredWidth(20);
tCidades.getColumnModel().getColumn(1).setPreferredWidth(200);
tCidades.getColumnModel().getColumn(2).setPreferredWidth(20);



//instancia do objeto modelo da classe defaultTableModel para receber o modelo da minha tabela para manuzear-mos

DefaultTableModel modelo = (DefaultTableModel) tCidades.getModel();
modelo.setNumRows(0);//toda vez que o metodo é chamado ele zera o num de lihas para preencher logo abaixo com novos dados

    try {

        con_bairros.resultset.first();
        do{
                //formatada a data do banco para dd/mm/aaaa para mostrar na tabela
                formataDataBancoParaJTable(con_bairros.resultset.getString("data_cadastro"));// formatando data p/ dd/mm/aaaa

                //equivale a uma linha na minha tabela Bombona
                modelo.addRow(new Object[]{con_bairros.resultset.getString("cod_bairro"),   // codigo do bairro
                                           con_bairros.resultset.getString("nome_bairro"),  // nome do bairro
                                           dataFormatadataJTable});                           //Data


        }while(con_bairros.resultset.next());//enquanto tiver dados preenche o jtable com os valores
        
                //depois que finaliza atualiza o resultset
                atualizaResultset();
                preencherListaBairros();
                //System.out.println("preencheu CIDADES");
                
                mostrarDados();
    }

    catch (Exception e) {
        JOptionPane.showMessageDialog(null, "NENHUM REGISTRO DE BAIRRO");
        limpaCampos();
        cb_listaBairros.removeAllItems();

    }



}//fim preencherJtable

public void atualizaResultset(){
try{

    con_bairros.executeSQL("select * from cad_bairro order by "+ordenacao);
    con_bairros.resultset.first();
    

}
catch(Exception e){

  JOptionPane.showMessageDialog(null, "Não atualizado, tente novamente.Erro:"+e);

}

}//fim atualiza resultSet

public void formataDataBancoParaJTable(String data){
String dia, mes, ano;

        ano = data.substring(0, 4);
        mes = data.substring(5, 7);
        dia = data.substring(8, 10);

        dataFormatadataJTable = dia+"-"+mes+"-"+ano;

}//fim convert area text

public void btNavega(){
        try{


            if(direcao.equals("primeiro"))
                con_bairros.resultset.first();

            else if(direcao.equals("anterior"))
                con_bairros.resultset.previous();

            else if(direcao.equals("proximo"))
                con_bairros.resultset.next();

            else
                con_bairros.resultset.last();

            //mostra os dados
            mostrarDados();
        }
        catch(Exception e){

        }
}

public void mostrarDados(){

            if(validaLogin.USUARIO.equals("Gerente"))
                tf_nome.setEditable(false);

            try{

                habilitaBotoes(true);

                tf_cod.setText(con_bairros.resultset.getString("cod_bairro"));                    //codigo do bairro
                tf_nome.setText(con_bairros.resultset.getString("nome_bairro"));              //nome da cidade

            }
            catch(Exception e){

                if(navega == 1)
                    JOptionPane.showMessageDialog(null, "Você já está no primeiro registro", "Aviso", JOptionPane.WARNING_MESSAGE);
                else if(navega == 2)
                    JOptionPane.showMessageDialog(null, "Você já está no ultimo registro", "Aviso", JOptionPane.WARNING_MESSAGE);
                else
                    JOptionPane.showMessageDialog(null, "Dados não localizados "+e, "Aviso", JOptionPane.WARNING_MESSAGE);

                    navega = 0;
            }

}//fim mostrar dados

public void excluirRegistro(){

    try{

                    String sql = "select * from cad_bairro where cod_bairro = "+tf_cod.getText();
                    con_bairros.executeSQL(sql);
                    //posiciona no primeiro registro
                    con_bairros.resultset.first();

                    String nome = "Deletar o bairro: "+con_bairros.resultset.getString("nome_bairro");

                    int op = JOptionPane.showConfirmDialog(null, nome, "Deletar bairro", JOptionPane.YES_NO_OPTION);

                    if(op == JOptionPane.YES_OPTION){

                        sql = "DELETE FROM cad_bairro WHERE cod_bairro ="+tf_cod.getText();

                        int conseguiu_excluir = con_bairros.statement.executeUpdate(sql);

                        if(conseguiu_excluir == 1){

                            JOptionPane.showMessageDialog(null, "Excluído com sucesso!");
                            atualizaResultset();
                            preencherJtable();

                       }
                    }
                    else{
                            atualizaResultset();
                            preencherJtable();


                            return;
                    }
        }//fim try
catch(Exception e){
    JOptionPane.showMessageDialog(null, "Erro ao tentar excluir o registro\nErro: "+e, "Erro", JOptionPane.ERROR_MESSAGE);
}
}//final excluir registro


public void atualizaDados(){

    String sql;
    try{

    sql = "UPDATE cad_bairro SET nome_bairro = '"+tf_nome.getText()+"'" +
                                    " where cod_bairro = "+tf_cod.getText();

    con_bairros.statement.executeUpdate(sql);

    JOptionPane.showMessageDialog(null, "Atualização efetuada com sucesso!");

        atualizaResultset();
        preencherJtable();
      
        //se o registro for feito da da tela de clientes
        if(auxiliar.validaCadCli.atualizaDadosManutencao == true){
            auxiliar.validaCadCli.preencherListaDeBairros();
            auxiliar.validaCadCli.mostraDadosCadCli();
        }



}//fim ry
catch(Exception e){
    JOptionPane.showMessageDialog(null, "Não foi possível atualizar o registro, verifique o que foi digitado nos campos\nErro: "+e, "Erro", JOptionPane.ERROR_MESSAGE);
}
}//fim atualiza dados

public void preencherListaBairros(){
    
        int contaBairros = 0;

        //remove todos os itens
        con_bairros.executeSQL("SELECT * FROM CAD_BAIRRO ORDER BY NOME_BAIRRO");

        cb_listaBairros.removeAllItems();

        try{
                con_bairros.resultset.first();

                do{
                    contaBairros++;

                    cb_listaBairros.addItem(con_bairros.resultset.getString("nome_bairro"));


                }while(con_bairros.resultset.next());

                    tf_qtdBairros.setText(contaBairros+"");


                //VOLTA AO PRIMEIRO REGISTRO
                con_bairros.resultset.first();



    }

    catch(Exception e){

           System.out.println("erro ao tentar preencher a lista\nErro: "+e);
           cb_listaBairros.removeAllItems();

    }

}//fim preenche lista

public void validaCampos(){
        String msg = "";
        grava = false;


        if(tf_nome.getText().isEmpty()){
            msg = "Informe o nome da cidade";
            tf_nome.requestFocus();
            grava = false;
        }
        else
            grava = true;//altoriza a gravação


        if(grava == false){
            JOptionPane.showMessageDialog(null, msg, "Aviso", JOptionPane.WARNING_MESSAGE);

        }
}//fim valida matricula

public void cliqueGrid(){
    //pega a linha que foi clicada na TABELA
    int linha = tCidades.getSelectedRow();
    //pega o modelo da tabela
    TableModel modelo = (TableModel) tCidades.getModel();
    //pega o tf_cod do cliente que está na linha que foi clicada e coluna 0 (primeira)
    String codBairroClicado = String.valueOf(modelo.getValueAt(linha, 0));
    //var que vai gurdar o tf_cod pesquisado no banco
    String codBairroPesquisado;
    //vai determinar o fim do laço
    String igual = "n";



    try{
            //vai para o primeiro registro
            con_bairros.resultset.first();

            do{

                codBairroPesquisado = con_bairros.resultset.getString("cod_bairro");

                //se o tf_cod que foi clicado na gride for igual ao que está no banco
                if(codBairroPesquisado.equals(codBairroClicado)){
                    mostrarDados();
                    igual = "s";//sai do laço e mostra dados
                }
                else
                    con_bairros.resultset.next();
                    
            }while(igual.equals("n"));

    }//fim try

    catch(Exception e){
            JOptionPane.showMessageDialog(null, e);
    }

}//fim click grid

public void pesquisarBairroPorNome(){

    try{

        //TableModel modelo = (TableModel) CadastroClientee.tabelaCliente.getModel();
        
        String pesquisado, bairro = "", cidade = "";
        String nomePesquisado = tf_consulta.getText().toUpperCase();
        String igual = "n";
        int tamanho_pesquisa = tf_consulta.getText().length();
        int tamanho_pesquisado;


                con_bairros.resultset.first();

                do{
                //teste para saber se o que foi pesquisado no banco tem a qtd de caracteres menor do que o que está sendo pesquisado
                tamanho_pesquisado = con_bairros.resultset.getString("nome_bairro").length();

                    if(tamanho_pesquisado < tamanho_pesquisa)
                        con_bairros.resultset.next();

                    else{
                        pesquisado = con_bairros.resultset.getString("nome_bairro").substring(0 , (tamanho_pesquisa)).toUpperCase();

                        if(nomePesquisado.equals(pesquisado)){

                            bairro = con_bairros.resultset.getString("nome_bairro");
                            igual = "s";

                        }
                        
                        else
                            con_bairros.resultset.next();
                    } 
                 }
                 while(igual.equals("n"));
            
                    cb_listaBairros.setSelectedItem(bairro);
                    cb_listaBairros.requestFocus();
                    mostrarDados();

    }
    catch(Exception e){
        JOptionPane.showMessageDialog(null, "Não há registro compatível. Tente novamente");
    }

}

public void informaBairro(){

try{
    String igual = "n";
    con_bairros.resultset.first();

    do{
            //se o nome do bairro que esta no banco for igual ao nome selecionado no congobox lista de bairros...
            if(con_bairros.resultset.getString("nome_bairro").equals(cb_listaBairros.getSelectedItem().toString())){
                mostrarDados();
                igual = "s";

            }
            else{

                con_bairros.resultset.next();
            }

    }while(igual.equals("n"));

}catch(Exception e){
    System.out.println("Erro :"+e);
}


}

public void habilitaBotoes(boolean h){

    btPrimeiro.setEnabled(h);
    btAnterior.setEnabled(h);
    btProximo.setEnabled(h);
    btUltimo.setEnabled(h);
    btExcluir.setEnabled(h);


}

}